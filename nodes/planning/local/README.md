# Local plannning


## velocity_local_planner

The `velocity_local_planner` node is responsible for generating a local path that can be followed by the vehicle, using the smoothed_path as a reference. The local path is generated based on the current position of the vehicle and the surrounding environment, such as detected objects, traffic lights, and stop lines. `velocity_local_planner` changes only the speeds of the smoothed_path depending on the detected objects and traffic lights.


#### Parameters

| Name | Type | Default | Description |
|------|------|---------|-------------|
|`~local_path_length` | double | `100` | The maximum length of the local path in meters (m) |
|`~nearest_neighbor_search` | string | `"kd_tree"` | The algorithm used for nearest neighbor search, alternative options: kd_tree, ball_tree, brute, auto|
|`braking_safety_distance_obstacle` | double | `4.0` | Determines the stopping point (m) of the ego vehicle before the obstacle |
|`braking_safety_distance_stopline` | double | `2.0` | Determines the stopping point (m) of the ego vehicle before the stop line |
|`braking_safety_distance_goal` | double | `0.0` | Determines the stopping point (m) of the ego vehicle before the goal point |
|`braking_reaction_time` | double | `1.6` | The time it takes the vehicle to react to an object in front of it  (s) |
|`stopping_lateral_distance` | double | `1.35` | Obstacles within this with (m) are considered on the path and blocking |
|`slowdown_lateral_distance` | double | `1.60` | Obstacles outside `stopping_laterl_distance`, but inside this width (m) are affecting ego vehicle speed by causing slowing down the target speed depending how close they are to the path |
|`waypoint_interval` | double | `1.0` | Default interval of the waypoints (m) |
|`dense_waypoint_interval` | double | `0.1` | Interval for the dense local path points (m) |
|`current_pose_to_car_front` | double | `4.0` | The distance from the current pose of the vehicle to the front of the car (m) |
|`default_deceleration` | double | `1.0` | The maximum rate at which the vehicle can decelerate (m/s2) |
|`tfl_maximum_deceleration` | double | `2.7` | If deceleration needed to stop behind the stop line exceeds this value then traffic light is ignored (m/s2) |
|`stopping_speed_limit` | double | `1.0` | Speed limit (m/s) for other vehicles to consider them as stopped |


#### Subscribed Topics

| Name | Type | Description |
|------|------|-------------|
|`smoothed_path` | `autoware_msgs/Lane` | The smoothed global path |
|`/localization/current_pose` | `geometry_msgs/PoseStamped` | The current pose of the vehicle |
|`/localization/current_velocity` | `geometry_msgs/TwistStamped` | The current velocity of the vehicle |
|`/detection/detected_objects` | `autoware_msgs/DetectedObjectArray` | Detected objects |
|`/detection/traffic_light_status` | `autoware_msgs/TrafficLightResultArray` | Traffic light status |


#### Published Topics

| Name | Type | Description |
|------|------|-------------|
|`/local_path` | `autoware_msgs/Lane` | The local path generated by the node |
